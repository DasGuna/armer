

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Creating a Hardware Package &mdash; Armer Driver  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Creating a Robotics Toolbox model" href="create_an_RTB_model.html" />
    <link rel="prev" title="Working With A New Arm" href="working_with_a_new_arm.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2c3e50" >
          

          
            <a href="index.html" class="icon icon-home"> Armer Driver
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="armer_installation.html">Armer Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_a_new_arm.html">Working With A New Arm</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Creating a Hardware Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-launch-file">Creating a Launch File</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-configuration-file">Creating a Configuration File</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Putting it All Together</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="create_an_RTB_model.html">Creating a Robotics Toolbox model</a></li>
<li class="toctree-l1"><a class="reference internal" href="set_joint_velocity.html">Setting Joint Velocites</a></li>
<li class="toctree-l1"><a class="reference internal" href="set_cartesian_velocity.html">Setting Cartesian Velocites</a></li>
<li class="toctree-l1"><a class="reference internal" href="set_joint_position.html">Setting Joint Positions</a></li>
</ul>
<p class="caption"><span class="caption-text">Code:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="API.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Modules</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Armer Driver</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Creating a Hardware Package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/creating_a_hardware_package.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="creating-a-hardware-package">
<h1>Creating a Hardware Package<a class="headerlink" href="#creating-a-hardware-package" title="Permalink to this headline">¶</a></h1>
<p>Armer drivers provide a high level interface to command a manipulator. Armer relies on the manipulator’s ROS driver implementation to communicate with the low level hardware.</p>
<p>For convenience, a hardware package should be created to launch the drivers for an arm or arm group. This consists of:</p>
<ul class="simple">
<li>A <a class="reference external" href="http://wiki.ros.org/roslaunch/XML">ROS launch file</a> which launches the manipulator drivers and then the Armer drivers</li>
<li>A <a class="reference external" href="http://wiki.ros.org/YAML%20Overview">yaml configuration file</a> which sets run time parameters such as the model being launched and the type of backend</li>
</ul>
<p>These files are packaged togther as a hardware package. To skip to folder structure and naming convention, see the <a class="reference external" href="creating_a_hardware_package.html#putting-it-all-together">Putting it All Together</a> section of this guide.</p>
<p>Examples of hardware packages can be seen with the <a class="reference external" href="https://github.com/qcr/armer_panda/">armer_panda</a> or the <a class="reference external" href="https://github.com/qcr/armer_ur/">armer_ur</a> packages.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">At this point in time, only manipulators with joint velocity controllers are supported by Armer. If an arm does not support this, it cannot be used with the Armer drivers.</p>
</div>
<div class="section" id="creating-a-launch-file">
<h2>Creating a Launch File<a class="headerlink" href="#creating-a-launch-file" title="Permalink to this headline">¶</a></h2>
<p>This is a ROS launch file which starts the manipulator’s drivers as well as the Armer driver. This is achieved by combining the contents of the ROS driver launch file with the <a class="reference external" href="https://github.com/qcr/armer/blob/master/launch/armer.launch/">armer.launch</a> file found in the Armer driver package.</p>
<ol class="arabic">
<li><p class="first">If they have not already been installed, install the ROS drivers for the manipulator. This can generally be done by googling <code class="docutils literal notranslate"><span class="pre">{ROBOT_MODEL}</span> <span class="pre">ROS</span> <span class="pre">drivers</span></code> and following their readme instructions.</p>
</li>
<li><p class="first">After the drivers have been installed to the relevant workspace, read the ROS driver’s documentation to find the launch file that starts the driver.</p>
<blockquote>
<div><p>Copy and paste the manipulator driver’s launch file contents into the template below and name the file <code class="docutils literal notranslate"><span class="pre">robot_bringup.launch</span></code>:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;launch&gt;</span>
    <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;config&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;sim&quot;</span> <span class="na">default=</span><span class="s">&quot;false&quot;</span> <span class="nt">/&gt;</span>

    <span class="c">&lt;!-- Physical Robot --&gt;</span>
    <span class="nt">&lt;group</span> <span class="na">unless=</span><span class="s">&quot;$(arg sim)&quot;</span><span class="nt">&gt;</span>

        <span class="c">&lt;!-- Manipulator driver --&gt;</span>
        <span class="c">&lt;!--INCLUDE OR COPY THE CONTENTS OF THE MANIPULATOR&#39;S ROS DRIVER LAUNCH FILE HERE --&gt;</span>

        <span class="c">&lt;!-- Launch armer driver --&gt;</span>
        <span class="nt">&lt;include</span> <span class="na">file=</span><span class="s">&quot;$(find armer)/launch/armer.launch&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;config&quot;</span> <span class="na">value=</span><span class="s">&quot;$(arg config)&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/include&gt;</span>
    <span class="nt">&lt;/group&gt;</span>

    <span class="c">&lt;!-- Simulated Robot --&gt;</span>
    <span class="nt">&lt;group</span> <span class="na">if=</span><span class="s">&quot;$(arg sim)&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;include</span> <span class="na">file=</span><span class="s">&quot;$(find armer)/launch/armer.launch&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;config&quot;</span> <span class="na">value=</span><span class="s">&quot;$(arg config)&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/include&gt;</span>
    <span class="nt">&lt;/group&gt;</span>
<span class="nt">&lt;/launch&gt;</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="creating-a-configuration-file">
<h2>Creating a Configuration File<a class="headerlink" href="#creating-a-configuration-file" title="Permalink to this headline">¶</a></h2>
<p>To configure parameters such as if armer is interfacing with a simulation or a physical arm, a yaml config file should be created.</p>
<p>Armer uses the Robotics Toolbox to perform calculations and this config file will point to the Robotics toolbox ERobot object so movement can be processed. If the manipulator does not have an existing RTB model or if unsure, see <a class="reference external" href="create_an_RTB_model.html#creating-a-robotics-toolbox-model/">Creating a Robotics Toolbox model</a>.</p>
<p>Create a config for launching the physical robot backend using the following as an example template and saved as <code class="docutils literal notranslate"><span class="pre">{ROBOT_MODEL}_{BACKEND_MODE}.yaml</span></code> where backend mode is <cite>“real”</cite> for a physical robot config and <cite>“sim”</cite> for a Swift sim robot:</p>
<blockquote>
<div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">robots</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nv">DESIRED_ROBOT_NAMESPACE</span><span class="p p-Indicator">}</span>
    <span class="nt">model</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">roboticstoolbox.models.{ROBOTIC_TOOLBOX_MODEL_NAME}</span>
<span class="nt">backend</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nv">DESIRED_BACKEND_TYPE</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Most parameters can be left as defaults, but these are the essential parameters that should be changed for basic functionality.</p>
<table border="1" class="colwidths-given docutils" id="id2">
<caption><span class="caption-text">Key configuration parameters</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field Name</th>
<th class="head">Description</th>
<th class="head">Example</th>
<th class="head">Default</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>name</td>
<td>namespace to be used</td>
<td><cite>“my_cool_robot”</cite></td>
<td><code class="docutils literal notranslate"><span class="pre">None</span></code></td>
</tr>
<tr class="row-odd"><td>model</td>
<td>robotics toolbox model to use</td>
<td>roboticstoolbox.models.Panda</td>
<td><code class="docutils literal notranslate"><span class="pre">None</span></code></td>
</tr>
<tr class="row-even"><td>backend</td>
<td>backend to be used</td>
<td>roboticstoolbox.backends.Swift.Swift</td>
<td><code class="docutils literal notranslate"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>The two current options for backend are:</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">roboticstoolbox.backends.Swift.Swift</span></code> (Swift simulation robot)</li>
<li><code class="docutils literal notranslate"><span class="pre">armer.backends.ROS.ROS</span></code> (Physical robot)</li>
</ul>
</dd>
</dl>
<p>Multiple robots can be launched at a time and parameters for each individual instance can be set under the corresponding namespace. For example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">robots</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">panda</span>
    <span class="l l-Scalar l-Scalar-Plain">model</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">roboticstoolbox.models.Panda</span>
    <span class="l l-Scalar l-Scalar-Plain">origin</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">-1</span><span class="p p-Indicator">]</span>
<span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ur5</span>
    <span class="l l-Scalar l-Scalar-Plain">model</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">roboticstoolbox.models.UR5</span>
    <span class="l l-Scalar l-Scalar-Plain">origin</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">,</span> <span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">0</span><span class="p p-Indicator">]</span>
<span class="nt">backend</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">roboticstoolbox.backends.Swift.Swift</span>
</pre></div>
</div>
<p>In this example, a Panda and a UR5 arm are being launched with different origin settings. The options for each different robot section is signaled with the <code class="docutils literal notranslate"><span class="pre">-</span></code> symbol before the name parameter.</p>
<p>The following parameters are available for setting in multi or single robot operations.</p>
<table border="1" class="colwidths-given docutils" id="id3">
<caption><span class="caption-text">Robot parameters</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="10%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field Name</th>
<th class="head">Description</th>
<th class="head">Example</th>
<th class="head">Default</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>joint_state_topic</td>
<td>topic to listen to joint states on</td>
<td><cite>“/my_joint_states”</cite></td>
<td><cite>“/joint_states”</cite></td>
</tr>
<tr class="row-odd"><td>joint_velocity_topic</td>
<td>topic to listen to velocity on</td>
<td><cite>“/my_controller/joint_velocity”</cite></td>
<td><cite>“/joint_group_velocity_controller/command”</cite></td>
</tr>
<tr class="row-even"><td>origin</td>
<td>set a different origin for the robot</td>
<td><cite>[-1, 0, 0, 0, 0, 0]</cite></td>
<td><cite>[0, 0, 0, 0, 0, 0]</cite></td>
</tr>
<tr class="row-odd"><td>gripper</td>
<td>specify the end effector link</td>
<td><cite>“tool0”</cite></td>
<td><code class="docutils literal notranslate"><span class="pre">None</span></code></td>
</tr>
<tr class="row-even"><td>logging: frequency</td>
<td>sets the frequency of logging</td>
<td><code class="docutils literal notranslate"><span class="pre">false</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">None</span></code></td>
</tr>
</tbody>
</table>
<p>Certain arms (such as the UR3) have multiple end effectors so specifying the link must be done by adding a “gripper” field to the robots section with the link name as a string.</p>
</div></blockquote>
</div>
<div class="section" id="id1">
<h2>Putting it All Together<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>For ease of deployment and use, the launch and config file should be packaged into a ROS package. The overall file structure is as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>armer_<span class="o">{</span>ROBOT_MODEL<span class="o">}</span>/
    ├─ launch/
    │   ├─ robot_bringup.launch
    ├─ cfg/
    │   ├─ <span class="o">{</span>ROBOT_MODEL<span class="o">}</span>_<span class="o">{</span>BACKEND_MODE<span class="o">}</span>.yaml
</pre></div>
</div>
<ol class="arabic">
<li><p class="first">The name of the package should be <code class="docutils literal notranslate"><span class="pre">armer_{ROBOT_MODEL}</span></code>.</p>
</li>
<li><p class="first">The launch file should be placed in the <code class="docutils literal notranslate"><span class="pre">armer_{ROBOT_MODEL}/launch</span></code> directory.</p>
</li>
<li><p class="first">Relevant config files should be placed in <code class="docutils literal notranslate"><span class="pre">armer_{ROBOT_MODEL}/cfg</span></code>.</p>
</li>
<li><p class="first">The package can be created by running <code class="docutils literal notranslate"><span class="pre">catkin_create_pkg</span> <span class="pre">armer_{ROBOT_MODEL}/</span></code> in the directory above <code class="docutils literal notranslate"><span class="pre">armer_{ROBOT_MODEL}</span></code>.</p>
</li>
<li><p class="first">The package can be built by running <code class="docutils literal notranslate"><span class="pre">catkin_make</span></code> in the main workspace directory</p>
</li>
<li><p class="first">If all has gone well, the ROS drivers and the Armer drivers should be started after running:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>roslaunch armer_<span class="o">{</span>ROBOT_MODEL<span class="o">}</span> robot_bringup.launch
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For further details on creating a ROS package see <a class="reference external" href="http://wiki.ros.org/ROS/Tutorials/CreatingPackage">http://wiki.ros.org/ROS/Tutorials/CreatingPackage</a>.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="create_an_RTB_model.html" class="btn btn-neutral float-right" title="Creating a Robotics Toolbox model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="working_with_a_new_arm.html" class="btn btn-neutral float-left" title="Working With A New Arm" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Gavin Suddrey.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>